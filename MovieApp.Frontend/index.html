<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MovieDB - Your Movie Collection</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Auth Page -->
    <div id="authPage" class="container">
        <div class="auth-container">
            <h1 style="text-align: center; margin-bottom: 30px;">üé¨ MovieDB</h1>
            
            <div class="auth-tabs">
                <button class="tab-btn active" onclick="switchTab('login')">Login</button>
                <button class="tab-btn" onclick="switchTab('register')">Register</button>
            </div>

            <div id="authError" class="error-message hidden"></div>
            <div id="authSuccess" class="success-message hidden"></div>

            <!-- Login Form -->
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginUsername">Username</label>
                    <input type="text" id="loginUsername" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" style="width: 100%;">Login</button>
            </form>

            <!-- Register Form -->
            <form id="registerForm" class="hidden">
                <div class="form-group">
                    <label for="registerUsername">Username</label>
                    <input type="text" id="registerUsername" minlength="3" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" minlength="6" required>
                </div>
                <div class="form-group">
                    <label for="registerRole">Role</label>
                    <select id="registerRole">
                        <option value="User">User</option>
                        <option value="Admin">Admin</option>
                    </select>
                </div>
                <button type="submit" style="width: 100%;">Register</button>
            </form>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
        <header>
            <div class="header-content">
                <h1>üé¨ MovieDB</h1>
                <div class="user-info">
                    <span class="user-badge" id="userDisplay"></span>
                    <button onclick="logout()">Logout</button>
                </div>
            </div>
        </header>

        <div class="container">
            <div class="controls">
                <input type="text" id="searchBox" class="search-box" placeholder="Search movies...">
                <select id="genreFilter">
                    <option value="">All Genres</option>
                    <option value="Action">Action</option>
                    <option value="Comedy">Comedy</option>
                    <option value="Drama">Drama</option>
                    <option value="Horror">Horror</option>
                    <option value="Sci-Fi">Sci-Fi</option>
                    <option value="Thriller">Thriller</option>
                    <option value="Romance">Romance</option>
                    <option value="Fantasy">Fantasy</option>
                    <option value="Adventure">Adventure</option>
                </select>
                <button id="addMovieBtn" class="hidden" onclick="openAddModal()">+ Add Movie</button>
            </div>

            <!-- Top 10 Movies Widget -->
            <div class="top-movies-widget">
                <div class="widget-header">
                    <h2>üèÜ Top 10 Movies</h2>
                    <div class="widget-badge">via gRPC</div>
                </div>
                <div id="topMoviesList" class="top-movies-list">
                    <div class="loading">Loading top movies...</div>
                </div>
            </div>

            <!-- Activity Feed -->
            <div id="activityFeed" class="activity-feed hidden">
                <div class="activity-header">
                    <h3>üì¢ Recent Activity</h3>
                    <button class="close-activity" onclick="toggleActivityFeed()">‚úï</button>
                </div>
                <div id="activityList" class="activity-list">
                    <div class="activity-empty">No recent activity</div>
                </div>
            </div>
            <button class="activity-toggle" onclick="toggleActivityFeed()">
                üì¢ Activity Feed
            </button>

            <div id="moviesContainer">
                <div class="loading">Loading movies...</div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Movie Modal -->
    <div id="movieModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Add Movie</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalError" class="error-message hidden"></div>
            <form id="movieForm">
                <input type="hidden" id="movieId">
                <div class="form-group">
                    <label for="movieTitle">Title</label>
                    <input type="text" id="movieTitle" required>
                </div>
                <div class="form-group">
                    <label for="movieDescription">Description</label>
                    <textarea id="movieDescription" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="movieYear">Release Year</label>
                    <input type="number" id="movieYear" min="1888" max="2100" required>
                </div>
                <div class="form-group">
                    <label for="movieGenre">Genre</label>
                    <select id="movieGenre" required>
                        <option value="">Select Genre</option>
                        <option value="Action">Action</option>
                        <option value="Comedy">Comedy</option>
                        <option value="Drama">Drama</option>
                        <option value="Horror">Horror</option>
                        <option value="Sci-Fi">Sci-Fi</option>
                        <option value="Thriller">Thriller</option>
                        <option value="Romance">Romance</option>
                        <option value="Fantasy">Fantasy</option>
                        <option value="Adventure">Adventure</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="movieRating">Rating (0-10)</label>
                    <input type="number" id="movieRating" min="0" max="10" step="0.1" required>
                </div>
                <button type="submit" style="width: 100%;">Save Movie</button>
            </form>
        </div>
    </div>

    <!-- SignalR Client Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/8.0.0/signalr.min.js"></script>
    
    <!-- gRPC-Web Client Library -->
    <script src="https://cdn.jsdelivr.net/npm/grpc-web@1.5.0/index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/google-protobuf@3.21.2/google-protobuf.js"></script>
    
    <script src="js/grpc-client.js"></script>
    <script src="js/app.js"></script>
</body>
</html>